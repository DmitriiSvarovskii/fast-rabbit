# Fast Rabbit VPN - Модульная архитектура

Веб-приложение для управления VPN-ключами с интеграцией Telegram Web App.

## Структура проекта

### Серверная часть (Node.js/Express)

```
├── config/
│   └── config.js              # Конфигурация приложения
├── controllers/
│   ├── pageController.js      # Контроллеры страниц
│   └── apiController.js       # Контроллеры API
├── middleware/
│   └── errorHandler.js        # Обработка ошибок
├── routes/
│   ├── pageRoutes.js          # Маршруты страниц
│   └── apiRoutes.js           # Маршруты API
├── services/
│   └── apiService.js          # Сервис для работы с внешним API
├── utils/
│   ├── telegramUtils.js       # Утилиты для Telegram
│   └── uiUtils.js             # Утилиты для UI
├── views/
│   ├── index.ejs              # Главная страница
│   └── key.ejs                # Страница ключа
├── public/
│   ├── css/
│   │   └── style.css          # Стили
│   ├── js/
│   │   ├── modules/           # Клиентские модули
│   │   │   ├── telegramModule.js
│   │   │   ├── uiModule.js
│   │   │   ├── apiModule.js
│   │   │   └── paymentModule.js
│   │   └── app.js             # Главный файл приложения
│   └── images/
├── app.js                     # Главный файл сервера
└── package.json
```

### Клиентская часть (JavaScript модули)

#### TelegramModule
- Инициализация Telegram Web App
- Работа с Telegram API
- Haptic feedback
- Открытие инвойсов и ссылок

#### UIModule
- Управление модальными окнами
- Система уведомлений
- Копирование в буфер обмена
- Создание элементов интерфейса

#### ApiModule
- HTTP запросы к API
- Загрузка данных пользователя
- Обновление UI

#### PaymentModule
- Обработка платежей
- Создание и удаление ключей
- История платежей

## Установка и запуск

1. Установите зависимости:
```bash
npm install
```

2. Настройте переменные окружения:
```bash
export API_BASE_URL=http://localhost:8000
export PORT=3000
export NODE_ENV=development
```

3. Запустите сервер:
```bash
npm start
```

## Функциональность

### Основные возможности:
- Управление VPN-ключами
- Пополнение баланса через Telegram Stars
- История платежей
- Интеграция с Telegram Web App
- Адаптивный дизайн

### API Endpoints:
- `GET /` - Главная страница
- `GET /key/:id` - Страница ключа
- `POST /api/payment` - Создание платежа
- `GET /api/user/:id` - Данные пользователя
- `GET /api/payment/:id` - История платежей
- `DELETE /api/keys/:id` - Удаление ключа
- `GET /api/servers` - Список серверов
- `POST /api/keys` - Создание ключа
- `POST /api/payments/stars/invoice` - Создание инвойса Stars
- `GET /api/balance/me` - Получение баланса

## Архитектурные преимущества

### Модульность
- Разделение ответственности между модулями
- Легкость тестирования и отладки
- Возможность независимой разработки модулей

### Масштабируемость
- Простое добавление новых функций
- Переиспользование кода
- Четкая структура проекта

### Поддерживаемость
- Централизованная конфигурация
- Единообразная обработка ошибок
- Логирование и мониторинг

## Разработка

### Добавление нового модуля:
1. Создайте файл в соответствующей директории
2. Экспортируйте модуль
3. Подключите в главном файле
4. Добавьте документацию

### Отладка:
- Используйте консоль браузера для клиентской части
- Проверяйте логи сервера
- Используйте инструменты разработчика

## Лицензия

ISC 